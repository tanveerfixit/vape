<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vape Supplier Order Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-100 text-slate-800">

<header class="bg-white shadow px-6 py-4">
  <h1 class="text-xl font-bold">Vape Supplier Order Builder</h1>
  <p class="text-sm text-slate-500">WhatsApp / SMS friendly order format</p>
</header>

<main class="p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">

  <!-- PRODUCT INPUT -->
  <section class="lg:col-span-2 space-y-4">

    <div class="bg-white rounded shadow p-4">
      <h2 class="font-semibold mb-3">Add Product</h2>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-3">
        <select id="category" class="border p-2 rounded"></select>
        <select id="brand" class="border p-2 rounded"></select>
        <select id="line" class="border p-2 rounded"></select>

        <div>
          <input id="flavour" list="flavourList"
            placeholder="Flavour (type or select)"
            class="border p-2 rounded w-full">
          <p id="flavourHint" class="text-xs text-slate-500 mt-1"></p>
        </div>
      </div>

      <div class="flex gap-3">
        <input id="qty" type="number" min="1" value="1"
          class="border p-2 rounded w-24">
        <button onclick="addToOrder()"
          class="bg-green-600 text-white px-4 py-2 rounded">
          Add to Order
        </button>
      </div>
    </div>

    <!-- ORDER TABLE -->
    <div class="bg-white rounded shadow p-4">
      <h2 class="font-semibold mb-2">Current Order</h2>

      <table class="w-full text-sm">
        <thead class="bg-slate-200">
          <tr>
            <th class="p-2 text-left">#</th>
            <th class="p-2 text-left">Product</th>
            <th class="p-2 text-left">Flavour</th>
            <th class="p-2 text-right">Qty</th>
          </tr>
        </thead>
        <tbody id="orderTable"></tbody>
      </table>
    </div>

  </section>

  <!-- COPY ORDER -->
  <aside>

    <div class="bg-white rounded shadow p-4">
      <h2 class="font-semibold mb-2">Shareable Order</h2>

      <textarea id="orderOutput" rows="18"
        class="w-full border p-2 rounded text-sm"></textarea>

      <button onclick="copyOrder()"
        class="mt-3 w-full bg-blue-600 text-white py-2 rounded">
        Copy for WhatsApp
      </button>

      <p id="msg" class="mt-2 text-sm font-semibold"></p>
    </div>

  </aside>

</main>

<script>
/* PRODUCT DATABASE */
const products = [
  { category: "Disposable Vape", brand: "Lost Mary", line: "BM6000" },
  { category: "Disposable Vape", brand: "IVG", line: "Smart 5500" },
  { category: "Disposable Vape", brand: "Elf Bar", line: "BC5000" },
  { category: "E-Liquid (Nic Salt)", brand: "ELFLIQ", line: "Nic Salts Series" }
];

/* FLAVOUR SUGGESTIONS */
const flavourSuggestions = [
  "Orange", "Banana Ice", "Blue Razz Lemonade",
  "Blueberry Sour Raspberry", "Cherry Cola",
  "Mango Ice", "Strawberry Ice", "Watermelon Ice"
];

/* STATE */
let order = [];

/* INIT SELECTORS */
const categoryEl = category;
const brandEl = brand;
const lineEl = line;
const flavourEl = flavour;
const flavourHint = document.getElementById("flavourHint");

function unique(arr, key) {
  return [...new Set(arr.map(i => i[key]))];
}
function fill(el, values) {
  el.innerHTML = values.map(v => `<option>${v}</option>`).join("");
}

function init() {
  fill(categoryEl, unique(products, "category"));
  categoryEl.onchange = updateBrands;
  brandEl.onchange = updateLines;
  updateBrands();
}
function updateBrands() {
  fill(brandEl, unique(products.filter(p => p.category === categoryEl.value), "brand"));
  updateLines();
}
function updateLines() {
  fill(lineEl, unique(products.filter(p =>
    p.category === categoryEl.value && p.brand === brandEl.value
  ), "line"));
}

/* FLAVOUR LIST */
const dl = document.createElement("datalist");
dl.id = "flavourList";
dl.innerHTML = flavourSuggestions.map(f => `<option value="${f}">`).join("");
document.body.appendChild(dl);

flavourEl.addEventListener("input", () => {
  const v = flavourEl.value.toLowerCase();
  flavourHint.textContent =
    v && !flavourSuggestions.some(f => f.toLowerCase().includes(v))
      ? "New flavour will be added as entered"
      : "";
});

/* ORDER LOGIC */
function addToOrder() {
  if (!flavourEl.value.trim()) return;

  order.push({
    category: categoryEl.value,
    brand: brandEl.value,
    line: lineEl.value,
    flavour: flavourEl.value.trim(),
    qty: Number(qty.value)
  });

  flavourEl.value = "";
  renderOrder();
}

function renderOrder() {
  orderTable.innerHTML = order.map((i, idx) => `
    <tr class="border-t">
      <td class="p-2">${idx + 1}</td>
      <td class="p-2">${i.brand} ${i.line}</td>
      <td class="p-2">${i.flavour}</td>
      <td class="p-2 text-right">${i.qty}</td>
    </tr>
  `).join("");

  const text = [
    "ðŸ§¾ Vape Order",
    "",
    ...order.map((i, idx) =>
      `${idx + 1}) ${i.brand} ${i.line}\n` +
      `   â€¢ ${i.category}\n` +
      `   â€¢ ${i.flavour}\n` +
      `   â€¢ Qty > ${i.qty}\n`
    )
  ].join("\n");

  orderOutput.value = text;
}

function copyOrder() {
  orderOutput.select();
  document.execCommand("copy");
  msg.textContent = "âœ… Order copied for WhatsApp";
  msg.className = "text-green-600 font-semibold mt-2";
}

init();
</script>

</body>
</html>
